{% set approvable = s == -3 and activity.decisions is not empty and activity.decisions|first.deciderUser == currentuser %}
<div class="row no-margin">
  <div class="col s8 center no-padding activity-content-stage" style="background-color: #feffe9;">
    <ol class='gray-periode stages activity-component' style="margin-left:{{activity.getStartdateDay()}}px ; width:{{activity.getPeriod()}}px">
    <ol class="stages blue-periode" style="margin-left: auto;" >
      {%  for stage in activity.stages %}
      {% if stage.getEnddate() <  date() %}
      <li class="stage-element completed-stages-element">
        <a href={{ url("manageActivityElement",{elmtType:"activity", elmtId: activity.id }) }} style="color:black !important" class="tooltipped stage-item-button-past completed-stages" data-position="top" data-html="true" data-tooltip='
        <div class="stage-name">
          <ul style="display: inline-flex; color: #2196F3; margin-right:3px" class="no-margin no-padding">
            <li>
              <i class="fa fa-cube" style="position: relative;top: -6%;left: 0%;font-size: 0.85rem;"></i>
            </li>
            <li>
              <i class="fa fa-cube" style="position: relative;top: 6%;left: -41%;font-size: 0.85rem;"></i>
            </li>
          </ul>
          <span>{{stage.name}}</span>
        </div>
        {% if stage.survey == null %}
        {% for criterion in stage.criteria %}
        <div class="criterion">
          <span class="cn-icon"  style="width:15px"><i class="{{criterion.cName.icon.type}} {{criterion.cName.icon.name}}"></i></span>
          <span>{{criterion.cName.name}} </span>
          </div>
          {% endfor %}
          {% else %}
          <div class="survey">
            <span class="cn-icon" style="width:15px"> Titre : {{stage.survey.name}}</span>
        </div>



          {% endif %}


        '>
        </a>
        <section class="stage-container completed-stages-container"></section>
      </li>

      {% else %}
      <li class="stage-element completed-stages-element">

        <a href={{ url("manageActivityElement",{elmtType:"activity", elmtId: activity.id }) }} style="color:black !important" class=" tooltipped stage-item-button completed-stages" data-position="top" data-html="true" data-tooltip='
        <div class="stage-name">
          <ul style="display: inline-flex; color: #2196F3; margin-right:3px" class="no-margin no-padding">
            <li>
              <i class="fa fa-cube" style="position: relative;top: -6%;left: 0%;font-size: 0.85rem;"></i>
            </li>
            <li>
              <i class="fa fa-cube" style="position: relative;top: 6%;left: -41%;font-size: 0.85rem;"></i>
            </li>
          </ul>
          <span>{{stage.name}}</span>
        </div>
        {% if stage.survey == null %}
        {% for criterion in stage.criteria %}
        <div class="criterion">
          <span class="cn-icon"  style="width:15px"><i class="{{criterion.cName.icon.type}} {{criterion.cName.icon.name}}"></i></span>
          <span>{{criterion.cName.name}} </span>
          </div>
          {% endfor %}
          {% else %}
          <div class="survey">
            <span class="cn-icon" style="width:15px"> Titre : {{stage.survey.name}}</span>
        </div>

  {% endif %}



        '></a>
        <section class="stage-container completed-stages-container"></section>
      </li>

      {% endif %}
    {% endfor %}
<!---<li class="collection-item activity-list--item">-->
  {#
  <div class="activity-actions">
    {% if approvable %}
      <a class="material-icons" href="">gavel</a>
    {% endif %}

    {% if activity.userCanGiveOutput(currentuser) %}
        {% if activity.userCanSendAnswerSurvey(currentuser) %}
          <a class="modal-trigger tooltipped btn-floating pulse" data-tooltip="Envoyer mes réponses" data-position="bottom" href="#sendDataModal">
            <i class="material-icons">send</i>
          </a>
          <a class="modal-trigger tooltipped btn-floating pulse" data-tooltip="Envoyer mes réponses" data-position="bottom" href="{{ path('sendAnswer', { surId: activity.activeGradableStages.first.survey.id }) }}?redirect={{ url(route,routeParams)|e('url') }}">
            <i class="material-icons">send</i>
          </a>
        {% endif %}
    {% endif %}



    {% if activity.userCanGiveOutput(currentuser) %}
      {% set userActiveGradableStages = activity.userActiveGradableStages(currentuser) %}
      {% if userActiveGradableStages %}
        {% if userActiveGradableStages|length > 1 %}
          <a class="material-icons tooltipped modal-trigger" data-tooltip={{ "activities.grade"|trans}} data-position="bottom" data-aid="{{activity.id}}" href="#chooseGradableStage">edit</a>
        {% else %}

            {% if userActiveGradableStages.first.survey is not null %}
                <a class="material-icons tooltipped" data-tooltip={{ "activities.grade"|trans}} data-position="bottom" href="{{ path('answerSurvey', { stgId: userActiveGradableStages.first.id }) }}">edit</a>
            {% else %}
              <a class="material-icons tooltipped" data-tooltip={{ "activities.grade"|trans}} data-position="bottom" href="{{ path('newStageGrade', { stgId: userActiveGradableStages.first.id }) }}">edit</a>
            {% endif %}

        {% endif %}
      {% endif %}
    {% endif %}

    {% if activity.userCanSeeOutput(currentuser) %}
      <a class="material-icons tooltipped" data-tooltip="{% trans %}activities.see_input{% endtrans %}" data-position="bottom" href="{{ path('newStageGrade', { stgId: activity.stages.first.id }) }}">remove_red_eye</a>
    {% endif %}


    {% if activity.userCanViewResults(currentuser) %}
      <a class="material-icons tooltipped" data-tooltip={ "result"|trans}} data-position="bottom" href="{{ path('activityResults', { actId: activity.id  }) }}">show_chart</a>
    {% endif %}

    {% if activity.userCanEdit(currentuser) %}
      <a class="material-icons tooltipped modal-trigger" data-tooltip={ "activities.modify"|trans}} href="#activityInfo" data-eid="{{activity.id}}" data-position="bottom">settings</a>
    {% else %}
      {% if activity.userCanAccessInfo(currentuser) %}
        <a class="material-icons tooltipped modal-trigger" href="#activityInfo" data-eid="{{activity.id}}" data-tooltip="{% trans %}activity_elements.access_activity_details{% endtrans %}" data-position="bottom">info_outline</a>
      {% endif %}
    {% endif %}
  </div>
  #}
      </li>
    </ol>
    </ol>
</div>

  <div class="col s4">
    {{ activity.name }}

    {% set activityClients =  activity.independantUniqueParticipatingClients %}
    {% if activityClients|length != 0 %}


      <div class="activity-clients">
        {% if activity.organization != currentuser.organization %}
          <small> - {{ 'from'|trans }}</small>
          <span class="activity-client-name">{{ activity.organization.commname }}</span>
          {% set activityClients = activityClients|filter((v,k) => v.clientOrganization != currentuser.organization) %}
        {% endif %}
        {% if activityClients|length != 0 %}

            <small> - {{ 'with'|trans }}</small>

            {% set k = 0 %}
            {% for client in activityClients if k < 2 %}

                  <a class="badge-container activity-client-name tooltipped" data-tooltip="{{client.commname}}">
                    <img class="client-logo" src="{{ asset(client_logo_url(client)) }}" alt="">
                  </a>

                {% set k = k + 1 %}
            {% endfor %}

            {% if activityClients|length - k > 0 %}
                  {{'and '|trans }}
                  <span class="activity-client-name tooltipped" data-position="top" data-html="true" data-tooltip="
                  {% for c, client in activityClients if c >= k %}
                      {{ activityClients[c].commname }} <br>
                  {% endfor %}
                  "
                  >{{ (activityClients|length - k) ~ ' other'|trans ~ (activityClients|length - k > 1 ? 's' : '')}}</span>
            {% endif %}
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>
